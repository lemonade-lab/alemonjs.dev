"use strict";(self.webpackChunkalemonjs_docs=self.webpackChunkalemonjs_docs||[]).push([[3554],{9954:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>a});var t=s(4848),r=s(8453);const o={title:"V2.1.0",description:"\u66f4\u65b0",authors:"ningmengchongshui",tags:["\u66f4\u65b0"],image:"https://i.imgur.com/mErPwqL.png",hide_table_of_contents:!1},i="\u66f4\u65b0\u8bb0\u5f55",l={permalink:"/blog/2025/05/30/releases/v2.1.0",source:"@site/blog/releases/2025/05/30/v2.1.0.md",title:"V2.1.0",description:"\u66f4\u65b0",date:"2025-05-30T00:00:00.000Z",tags:[{inline:!0,label:"\u66f4\u65b0",permalink:"/blog/tags/\u66f4\u65b0"}],readingTime:2.72,hasTruncateMarker:!1,authors:[{namne:"ningmengchongshui",title:"Co-creator of yunzaijs 1",url:"https://github.com/ningmengchongshui",email:"ningmengchongshui@gmail.com",socials:{github:"https://github.com/ningmengchongshui"},imageURL:"https://avatars.githubusercontent.com/u/110824794?v=4",key:"ningmengchongshui",page:null}],frontMatter:{title:"V2.1.0",description:"\u66f4\u65b0",authors:"ningmengchongshui",tags:["\u66f4\u65b0"],image:"https://i.imgur.com/mErPwqL.png",hide_table_of_contents:!1},unlisted:!1,nextItem:{title:"V2.0.16",permalink:"/blog/2025/05/13/releases/v2.0.16"}},c={authorsImageUrls:[void 0]},a=[{value:"\u65b0\u529f\u80fd\u793a\u4f8b",id:"\u65b0\u529f\u80fd\u793a\u4f8b",level:2},{value:"useSubscribe",id:"usesubscribe",level:3},{value:"useMessage",id:"usemessage",level:3},{value:"useClient",id:"useclient",level:3},{value:"defineResponse",id:"defineresponse",level:3},{value:"defineMiddleware",id:"definemiddleware",level:3},{value:"Route",id:"route",level:3}];function d(e){const n={admonition:"admonition",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsx)(n.p,{children:"\u9664\u5374\u8ba2\u9605hook\u5916\uff0c\u5176\u4ed6\u5185\u5bb9\u90fd\u5c06\u5411\u4e0b\u517c\u5bb9\u3002"})}),"\n",(0,t.jsx)(n.p,{children:"\u4e00 \u3001\u65b0\u589e\u7528\u4e8e\u5185\u90e8\u7684cbp\u534f\u8bae\uff0c\u6269\u5c55\u6027\u66f4\u5f3a\u3002\u5982\u652f\u6301\u4f5c\u4e3a\u670d\u52a1\uff0c\u8ba9\u5b50\u670d\u52a1\u8fdb\u884c\u8fde\u63a5\u3002\u540c\u65f6\u4e5f\u652f\u6301\u4e86\u5728\u73b0\u6709\u670d\u52a1\u4e0a\u5b9a\u4e49\u63a5\u53e3"}),"\n",(0,t.jsx)(n.p,{children:"\u4e8c\u3001 \u65b0\u589e\u5c40\u90e8\u7684\u54cd\u5e94\u4e2d\u95f4\u4ef6\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u4e09\u3001\u589e\u5f3a\u52a0\u8f7d\u5e73\u53f0\u5305\u548c\u5e94\u7528\u6267\u884c\u7684\u7a33\u5b9a\u6027\uff0c\u4e3b\u8981\u662f\u5b9e\u73b0\u4ee3\u7801\u5d29\u6e83\u53ef\u81ea\u52a8\u91cd\u542f\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u56db\u3001\u4f18\u5316hook\u7684\u8bbe\u8ba1\uff0c\u5305\u62ec\u6d88\u606f\u53d1\u9001\u548c\u4e8b\u4ef6\u8ba2\u9605\u7b49\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u4e94\u3001\u652f\u6301\u66f4\u591a\u7684\u4e2a\u6027\u5316\u914d\u7f6e\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u516d\u3001\u65b0\u589e\u66f4\u76f4\u89c2\u4e14\u6267\u884c\u6548\u7387\u66f4\u9ad8\u7684\u8def\u7531\u7cfb\u7edf\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u4e03\u3001\u652f\u6301\u53d1\u9001md\u3001buttons\u7b49\u6570\u636e\u683c\u5f0f\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u516b\u3001\u6574\u7406\u4e86\u4e00\u6279\u5e38\u7528\u7684\u5de5\u5177\u51fd\u6570\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u4e5d\u3001\u65b0\u589e\u66f4\u9002\u7528\u4e8e\u65b0\u67b6\u6784\u7684hook\uff0c\u4ee5\u8c03\u7528\u5e73\u53f0\u539f\u751f\u63a5\u53e3\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u5341\u3001\u4fee\u590d\u82e5\u5e72BUG\u3002"}),"\n",(0,t.jsx)(n.h2,{id:"\u65b0\u529f\u80fd\u793a\u4f8b",children:"\u65b0\u529f\u80fd\u793a\u4f8b"}),"\n",(0,t.jsx)(n.h3,{id:"usesubscribe",children:"useSubscribe"}),"\n",(0,t.jsx)(n.p,{children:"!!! useSubscribe \u548c 2.0 \u4e0d\u517c\u5bb9"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"import { Text, useMessage } from 'alemonjs'\nconst selects = onSelects(['message.create'])\nexport default onResponse(selects, event => {\n  const [subscribe] = useSubscribe(event, selects)\n  subscribe.monut(Res.current, ['UserId']) // res \u54cd\u5e94\u4e4b\u524d\n\n  // more ...\n  subscribe.create(Res.current, []) // res \u521b\u5efa\u4e4b\u540e\n  subscribe.unmonut(Res.current, []) // res \u54cd\u5e94\u4e4b\u540e\n})\n"})}),"\n",(0,t.jsx)(n.h3,{id:"usemessage",children:"useMessage"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"import { Text, useMessage } from 'alemonjs'\nconst selects = onSelects(['message.create'])\nexport default onResponse(selects, event => {\n  const [message] = useMessage(event)\n  message.send(format(Text('Hello Word!')))\n})\n"})}),"\n",(0,t.jsx)(n.h3,{id:"useclient",children:"useClient"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"import {\n  platform as qqbot,\n  useClient\n} from '@alemonjs/qq-bot'\nconst selects = onSelects(['message.create'])\nexport default onResponse(selects, event => {\n  if (event.platform === qqbot) {\n    const [client, value] = useClient(event)\n    // \u4f7f\u7528\u539f\u751fapi\u548c\u6570\u636e\n  }\n})\n"})}),"\n",(0,t.jsx)(n.h3,{id:"defineresponse",children:"defineResponse"}),"\n",(0,t.jsx)(n.p,{children:"\u652f\u6301\u5b9a\u4e49\u8def\u7531\u89c4\u5219\u6765\u66f4\u7ec6\u81f4\u5316\u7684\u63a7\u5236\u548c\u7ba1\u7406\u54cd\u5e94\u3002\u6709\u6548\u63d0\u9ad8\u5339\u914d\u6548\u7387\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",metastring:'title="src/router.ts"',children:"import { lazy } from 'alemonjs'\nexport default defineResponse([\n  {\n    // \u7528\u6237\u9a8c\u8bc1\u4e2d\u95f4\u4ef6\u3002\u8fd9\u662f\u5c40\u90e8\u7684\uff0c\u4ec5\u5bf9 children \u4e0b\u7684\u54cd\u5e94\u89c4\u5219\u751f\u6548\n    handler: lazy(() => import('@src/response/mw')),\n    children: [\n      {\n        // \u5339\u914d\u6b63\u5219\n        regular: /^(!|\uff01|\\/|#|\uff03)?\u6211\u7684\u4fe1\u606f/,\n        handler: lazy(\n          () =>\n            import('@src/response/user-message/base/res')\n        )\n      }\n    ]\n  }\n])\n"})}),"\n",(0,t.jsx)(n.h3,{id:"definemiddleware",children:"defineMiddleware"}),"\n",(0,t.jsx)(n.p,{children:"\u652f\u6301\u5b9a\u4e49\u4e2d\u95f4\u4ef6\u8def\u7531\u89c4\u5219\u6765\u66f4\u7ec6\u81f4\u5316\u7684\u63a7\u5236\u548c\u7ba1\u7406\u54cd\u5e94\u3002\u6709\u6548\u63d0\u9ad8\u5339\u914d\u6548\u7387\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",metastring:'title="src/router-mw.ts"',children:"import { lazy } from 'alemonjs'\nexport default defineMiddleware([\n  {\n    handler: lazy(() => import('./middleware/mw'))\n  }\n])\n"})}),"\n",(0,t.jsx)(n.h3,{id:"route",children:"Route"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"import { Context } from 'koa'\n\n// GET\nexport const GET = (ctx: Context, next) => {\n  ctx.status = 200\n  ctx.body = {\n    message: 'hello word !'\n  }\n}\n\n// POST\nexport const POST = (ctx: Context, next) => {\n  ctx.status = 200\n  ctx.body = {\n    message: 'hello word !'\n  }\n}\n\n// DELETE\n// PUT\n"})})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>l});var t=s(6540);const r={},o=t.createContext(r);function i(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);